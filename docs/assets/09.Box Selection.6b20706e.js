import{bF as e,bW as t,bX as o,bY as r,bM as n,bH as i,D as a,bJ as s,bZ as l,b_ as u,b$ as c,ae as f,a9 as d,M as h,V as p,c0 as y,c1 as _}from"./TileProperty.6da85ab0.js";import{O as m}from"./OSM.2ead155c.js";import{T as v}from"./Tile.28bcaf1f.js";import{V as g,a as b}from"./Vector.c3321bd0.js";import{G as F}from"./GeoJSON.6b41041b.js";import{m as E}from"./featureloader.82820175.js";import{i as A,j as T,c as L,b as S,t as j,F as w,o as O}from"./vendor.a926ca27.js";import"./XYZ.473ba1b0.js";import"./BaseTile.190efee2.js";import"./TileLayer.24fccdef.js";import"./JSONFeature.af6a5d11.js";import"./Feature.635c9857.js";var x,C=(x=function(e,t){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}x(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),I="select",M=function(e){function t(t,o,r,n){var i=e.call(this,t)||this;return i.selected=o,i.deselected=r,i.mapBrowserEvent=n,i}return C(t,e),t}(e),G={};var P=function(e){function c(a){var s=e.call(this)||this;s.on,s.once,s.un;var l,c,h=a||{};if(s.boundAddFeature_=s.addFeature_.bind(s),s.boundRemoveFeature_=s.removeFeature_.bind(s),s.condition_=h.condition?h.condition:t,s.addCondition_=h.addCondition?h.addCondition:o,s.removeCondition_=h.removeCondition?h.removeCondition:o,s.toggleCondition_=h.toggleCondition?h.toggleCondition:r,s.multi_=!!h.multi&&h.multi,s.filter_=h.filter?h.filter:n,s.hitTolerance_=h.hitTolerance?h.hitTolerance:0,s.style_=void 0!==h.style?h.style:(l=E(),f(l[d.POLYGON],l[d.LINE_STRING]),f(l[d.GEOMETRY_COLLECTION],l[d.LINE_STRING]),function(e){return e.getGeometry()?l[e.getGeometry().getType()]:null}),s.features_=h.features||new i,h.layers)if("function"==typeof h.layers)c=h.layers;else{var p=h.layers;c=function(e){return u(p,e)}}else c=n;return s.layerFilter_=c,s.featureLayerAssociation_={},s}return C(c,e),c.prototype.addFeatureLayerAssociation_=function(e,t){this.featureLayerAssociation_[a(e)]=t},c.prototype.getFeatures=function(){return this.features_},c.prototype.getHitTolerance=function(){return this.hitTolerance_},c.prototype.getLayer=function(e){return this.featureLayerAssociation_[a(e)]},c.prototype.setHitTolerance=function(e){this.hitTolerance_=e},c.prototype.setMap=function(t){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),e.prototype.setMap.call(this,t),t?(this.features_.addEventListener(s.ADD,this.boundAddFeature_),this.features_.addEventListener(s.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(s.ADD,this.boundAddFeature_),this.features_.removeEventListener(s.REMOVE,this.boundRemoveFeature_))},c.prototype.addFeature_=function(e){var t=e.element;this.style_&&this.applySelectedStyle_(t)},c.prototype.removeFeature_=function(e){var t=e.element;this.style_&&this.restorePreviousStyle_(t)},c.prototype.getStyle=function(){return this.style_},c.prototype.applySelectedStyle_=function(e){var t=a(e);t in G||(G[t]=e.getStyle()),e.setStyle(this.style_)},c.prototype.restorePreviousStyle_=function(e){for(var t=this.getMap().getInteractions().getArray(),o=t.length-1;o>=0;--o){var r=t[o];if(r!==this&&r instanceof c&&r.getStyle()&&-1!==r.getFeatures().getArray().lastIndexOf(e))return void e.setStyle(r.getStyle())}var n=a(e);e.setStyle(G[n]),delete G[n]},c.prototype.removeFeatureLayerAssociation_=function(e){delete this.featureLayerAssociation_[a(e)]},c.prototype.handleEvent=function(e){if(!this.condition_(e))return!0;var t=this.addCondition_(e),o=this.removeCondition_(e),r=this.toggleCondition_(e),n=!t&&!o&&!r,i=e.map,a=this.getFeatures(),s=[],c=[];if(n){l(this.featureLayerAssociation_),i.forEachFeatureAtPixel(e.pixel,function(e,t){if(this.filter_(e,t))return c.push(e),this.addFeatureLayerAssociation_(e,t),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var f=a.getLength()-1;f>=0;--f){var d=a.item(f),h=c.indexOf(d);h>-1?c.splice(h,1):(a.remove(d),s.push(d))}0!==c.length&&a.extend(c)}else{i.forEachFeatureAtPixel(e.pixel,function(e,n){if(this.filter_(e,n))return!t&&!r||u(a.getArray(),e)?(o||r)&&u(a.getArray(),e)&&(s.push(e),this.removeFeatureLayerAssociation_(e)):(c.push(e),this.addFeatureLayerAssociation_(e,n)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var p=s.length-1;p>=0;--p)a.remove(s[p]);a.extend(c)}return(c.length>0||s.length>0)&&this.dispatchEvent(new M(I,c,s,e)),!0},c}(c);const R=S("div",{id:"map",class:"map"},null,-1),N={setup(e){const t=A(""),o=new g({url:"https://openlayers.org/en/latest/examples/data//geojson/countries.geojson",format:new F}),r=new h({layers:[new v({source:new m({})}),new b({source:o})],view:new p({center:[0,0],zoom:2,minZoom:2,constrainRotation:16,rotation:Math.PI/3})}),n=new P;r.addInteraction(n);const i=n.getFeatures(),a=new y({condition:_});return r.addInteraction(a),a.on("boxend",(function(){const e=r.getView().getRotation(),t=e%(Math.PI/2)!=0,n=t?[]:i,s=a.getGeometry().getExtent();if(o.forEachFeatureIntersectingExtent(s,(function(e){n.push(e)})),t){const t=[0,0],o=a.getGeometry().clone();o.rotate(-e,t);const r=o.getExtent();n.forEach((function(o){const n=o.getGeometry().clone();n.rotate(-e,t),n.intersectsExtent(r)&&i.push(o)}))}})),a.on("boxstart",(function(){i.clear()})),i.on(["add","remove"],(function(){const e=i.getArray().map((function(e){return e.get("name")}));e.length>0?t.value=e.join(","):t.value="No countries selected"})),T((()=>{r.setTarget("map")})),(e,o)=>(O(),L(w,null,[R,S("span",null,j(t.value),1)],64))}};export{N as default};
